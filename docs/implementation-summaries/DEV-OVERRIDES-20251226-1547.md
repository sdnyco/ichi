# Dev Testing Overrides — 2025-12-26 15:47

## Environment Flags
- `CHECKIN_DURATION_MINUTES_DEV`: When set (and only when `NODE_ENV === "development"`), new check-ins ignore the user-selected duration and expire after the provided minutes. Useful value: `5`. **Commented in code as “Dev-only testing override; do not enable in production.”**
- `PINGS_DISABLE_RATE_LIMITS_DEV`: If `true` in dev, pings bypass both send and receive limits. Eligibility still enforces anchoring, availability, contact email, and block/banned checks.
- `PINGS_MAX_RECIPIENTS_DEV` (optional): Overrides the per-ping recipient cap (default remains 3). Clamped to a max of 10 and dev-gated like the other flags.

## Behavior Changes
- Check-in API now computes `effectiveDurationMinutes = override ?? body.durationMinutes`; overrides apply only in dev builds with the env set.
- Ping dayKey generation accepts `{ disableRateLimits: true }`. When the dev flag is on, dayKey becomes `DEV-<YYYY-MM-DD>-<HHmmss>-<rand>` (Europe/Berlin time) so the existing `UNIQUE(place_id, day_key)` constraint no longer blocks multiple dev sends.
- When rate limits are disabled:
  - `/api/pings/eligibility` reports `sendLimitAvailable=true` without querying the DB and still filters on anchored/available/blocked users.
  - `/api/pings` inserts events with the dev dayKey and skips both the pre-send recipient count filter and the post-insert recheck, allowing unlimited emails to the same anchors while testing.

## Notes
- Overrides are double-gated by `NODE_ENV === "development"` and the explicit env var. Production builds remain unchanged even if the env vars leak.
- Add the new env vars to `.env.local` (never committed). Example:
  ```
  CHECKIN_DURATION_MINUTES_DEV=5
  PINGS_DISABLE_RATE_LIMITS_DEV=true
  PINGS_MAX_RECIPIENTS_DEV=5
  ```

